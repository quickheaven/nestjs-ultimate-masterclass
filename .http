### Variable Definitions
@baseUrl = http://localhost:3000
@contentType = application/json

### Login to get token
# @name login
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
    "email": "test@example.com",
    "password": "test_password_123"
}

### Set the token variable
@token = {{login.response.body.accessToken}}

### Get all tasks
# @name getAllTasks
GET {{baseUrl}}/tasks?limit=10&offset=2
Authorization: Bearer {{token}}

### Get all in progress tasks
# @name getAllInProgressTasks
GET {{baseUrl}}/tasks?status=IN_PROGRESS
Authorization: Bearer {{token}}

### Get all tasks with search query
# @name getAllTasksWithSearch
GET {{baseUrl}}/tasks?search=07122025 0852
Authorization: Bearer {{token}}

### Get all tasks with search query
# @name getAllTasksFilteredByLabels
GET {{baseUrl}}/tasks?label=urgent
Authorization: Bearer {{token}}

### Get all tasks sorted by createdAt
# @name getAllTasksSortedByCreatedAt
GET {{baseUrl}}/tasks?sort=createdAt&order=DESC
Authorization: Bearer {{token}}

### Create a new task
# @name createTask
POST {{baseUrl}}/tasks
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
    "title": "Learn NestJS 07122025 1028",
    "description": "Complete the NestJS course",
    "status": "OPEN",
    "userId": "5685ac5d-34c6-4abd-9495-354b2a66cf9b",
    "labels": [
        {
            "name": "urgent"
        }
    ]
}

### Set the task id
@taskId = {{createTask.response.body.id}}

### Get one task
GET {{baseUrl}}/tasks/{{taskId}}
Authorization: Bearer {{token}}

### Update the task status
PATCH {{baseUrl}}/tasks/{{taskId}}/status
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
    "status": "IN_PROGRESS",
    "labels": []
}

### Update the task
PATCH {{baseUrl}}/tasks/{{taskId}}
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
    "status": "IN_PROGRESS",
    "labels": [{
        "name": "done"
    }]
}

### Delete a task
DELETE {{baseUrl}}/tasks/{{taskId}}
Authorization: Bearer {{token}}

### Add specific labels to task
# @name addLabels
POST {{baseUrl}}/tasks/{{taskId}}/labels
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

[
    {
        "name": "prioritize"
    },
    {
        "name": "bug"
    }
]

### Remove specific labels from task
# @name removeLabels
DELETE {{baseUrl}}/tasks/{{taskId}}/labels
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

["prioritize", "bug"]
